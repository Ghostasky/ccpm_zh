# 测试执行规则

所有测试命令中运行测试的标准模式。

## 核心原则

1. **始终使用来自 `.claude/agents/test-runner.md` 的 test-runner 代理**
2. **无模拟** - 使用真实服务以获得准确结果
3. **详细输出** - 捕获所有内容以供调试
4. **首先检查测试结构** - 在假设代码错误之前

## 执行模式

```markdown
为以下内容执行测试: {target}

要求:
- 使用详细输出运行
- 无模拟服务
- 捕获完整堆栈跟踪
- 如果发生失败则分析测试结构
```

## 输出重点

### 成功
保持简单：
```
✅ 所有测试通过（{count} 个测试用时 {time} 秒）
```

### 失败
专注于失败的内容：
```
❌ 测试失败: {count}

{test_name} - {file}:{line}
  错误: {message}
  修复: {suggestion}
```

## 常见问题

- 未找到测试 → 检查文件路径
- 超时 → 终止进程，报告不完整
- 缺失框架 → 安装依赖项

## 清理

测试后始终清理：
```bash
pkill -f "jest|mocha|pytest" 2>/dev/null || true
```

## 重要说明

- 不要并行化测试（避免冲突）
- 让每个测试完全完成
- 报告带有可操作修复的失败
- 专注于失败，而不是成功